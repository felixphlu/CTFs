---
description: VirusTotal, Powershell, any.run, lolbas
---

# LetsDefend\_CTF\_IcedIDMalwareFamily

<figure><img src=".gitbook/assets/image.png" alt=""><figcaption></figcaption></figure>

This CTF starts by asking for the sha256 hash of the malspam attacmment. I will use VirusTotal to check the file hash.

<figure><img src=".gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

<figure><img src=".gitbook/assets/image (3).png" alt=""><figcaption></figcaption></figure>

I could have also pulled the hashes by using “sha256sum”(Linux) or “Get-FileHash -Algorithm SHA256″(Windows) commands to get the SHA256 hash of the files. However, the malspam attachment would disappear after a few seconds as it is running a macro to self delete itself. For this reason, I used VirusTotal to check the SHA256 hash value.

The next question asks the following:

<figure><img src=".gitbook/assets/image (4).png" alt=""><figcaption></figcaption></figure>

For this question, I will use any.run and enter the SHA256 hash in the search.

I come out with a bunch of uploads&#x20;

<figure><img src=".gitbook/assets/image (8).png" alt=""><figcaption></figcaption></figure>

I will select one and I get the following:

<figure><img src=".gitbook/assets/image (5).png" alt=""><figcaption></figcaption></figure>

Now to answer the question, I will go to the child process of WINWORD.EXE which is explorer.exe and I can see the child process command line:

<figure><img src=".gitbook/assets/image (6).png" alt=""><figcaption></figcaption></figure>

<figure><img src=".gitbook/assets/image (7).png" alt=""><figcaption></figcaption></figure>

I could also use lolbas to check the files and when I download what malware can piggyback off the payload.

<figure><img src=".gitbook/assets/image (9).png" alt=""><figcaption></figcaption></figure>

The next question asks for the SHA256 file hash of the HTML application. I will use VirusTotal for this

<figure><img src=".gitbook/assets/image (10).png" alt=""><figcaption></figcaption></figure>

<figure><img src=".gitbook/assets/image (11).png" alt=""><figcaption></figcaption></figure>

Next question:

<figure><img src=".gitbook/assets/image (12).png" alt=""><figcaption></figcaption></figure>

I will use any.run for this again and check the DLL run method.

<figure><img src=".gitbook/assets/image (14).png" alt=""><figcaption></figcaption></figure>

I will copy the Command Line:

<figure><img src=".gitbook/assets/image (15).png" alt=""><figcaption></figcaption></figure>

<figure><img src=".gitbook/assets/image (16).png" alt=""><figcaption></figcaption></figure>

The next question:

<figure><img src=".gitbook/assets/image (17).png" alt=""><figcaption></figcaption></figure>

I will look at the image file dll installer on VirusTotal to get the SHA256 hash value:

<figure><img src=".gitbook/assets/image (18).png" alt=""><figcaption></figcaption></figure>

<figure><img src=".gitbook/assets/image (19).png" alt=""><figcaption></figcaption></figure>

Next question:

<figure><img src=".gitbook/assets/image (20).png" alt=""><figcaption></figcaption></figure>

I use any.run again to find any DNS requests and find:

<figure><img src=".gitbook/assets/image (21).png" alt=""><figcaption></figcaption></figure>

<figure><img src=".gitbook/assets/image (22).png" alt=""><figcaption></figcaption></figure>
